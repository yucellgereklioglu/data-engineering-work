INSERT INTO electric_vehicles (manufacturer, model, year, battery_type, battery_capacity_kwh, range_km, charging_type, charge_time_hr, price_usd)
VALUES
('Tesla', 'Model Y', 2023, 'Lithium-Ion', 75.0, 505, 'Supercharger', 1.2, 47000),
('Nissan', 'Ariya', 2022, 'Lithium-Ion', 87.0, 490, 'CCS', 5.0, 46000),
('BMW', 'iX3', 2021, 'Lithium-Ion', 80.0, 460, 'Type2', 6.5, 55000),
('Hyundai', 'Ioniq 5', 2023, 'Lithium-Ion', 77.4, 480, 'CCS', 4.8, 52000),
('Volkswagen', 'ID.3', 2022, 'Lithium-Ion', 58.0, 420, 'Type2', 6.0, 39000),
('Ford', 'F-150 Lightning', 2024, 'Lithium-Ion', 131.0, 480, 'CCS', 3.5, 68000),
('Kia', 'Niro EV', 2021, 'Lithium-Ion', 64.0, 385, 'Type2', 7.0, 41000),
('Renault', 'ZOE', 2020, 'Lithium-Ion', 52.0, 395, 'Type2', 8.0, 33000),
('Peugeot', 'e-208', 2022, 'Lithium-Ion', 50.0, 360, 'Type2', 7.5, 37000),
('BYD', 'Seal', 2023, 'LFP', 82.5, 550, 'CCS', 3.0, 42000),
('Lucid', 'Air Touring', 2024, 'Lithium-Ion', 92.0, 620, 'CCS', 2.5, 78000),
('XPeng', 'P7', 2022, 'LFP', 81.0, 560, 'Supercharger', 2.0, 45000),
('Volvo', 'C40 Recharge', 2023, 'Lithium-Ion', 78.0, 440, 'Type2', 5.5, 49000),
('Toyota', 'bZ3', 2024, 'Lithium-Ion', 65.0, 410, 'CCS', 6.0, 46000),
('Rivian', 'R1S', 2023, 'Lithium-Ion', 135.0, 510, 'CCS', 3.2, 87000),
('Tesla', 'Cybertruck', 2024, 'Lithium-Ion', 120.0, 560, 'Supercharger', 1.5, 90000),
('Nissan', 'Leaf Plus', 2021, 'Lithium-Ion', 62.0, 364, 'Type2', 6.5, 34000),
('BMW', 'i4', 2022, 'Lithium-Ion', 83.9, 590, 'CCS', 4.0, 62000),
('Hyundai', 'Ioniq 6', 2023, 'Lithium-Ion', 77.4, 614, 'CCS', 3.8, 54000),
('Volkswagen', 'ID. Buzz', 2024, 'Lithium-Ion', 82.0, 420, 'Type2', 6.5, 58000),
('Ford', 'Mustang Mach-E', 2022, 'Lithium-Ion', 91.0, 490, 'CCS', 4.5, 56000),
('Kia', 'EV6 GT', 2023, 'Solid-State', 77.4, 510, 'CCS', 3.2, 59000),
('Renault', 'Megane E-Tech', 2023, 'Lithium-Ion', 60.0, 450, 'CCS', 5.0, 42000),
('Peugeot', 'e-2008', 2021, 'Lithium-Ion', 50.0, 310, 'Type2', 7.0, 37000),
('BYD', 'Atto 3', 2022, 'LFP', 60.5, 420, 'Type2', 6.5, 31000),
('Lucid', 'Air Pure', 2023, 'Lithium-Ion', 88.0, 653, 'CCS', 2.2, 72000),
('XPeng', 'G9', 2023, 'LFP', 98.0, 650, 'Supercharger', 2.0, 59000),
('Volvo', 'EX30', 2024, 'Lithium-Ion', 64.0, 440, 'Type2', 4.8, 47000),
('Toyota', 'bZ4X', 2022, 'Lithium-Ion', 71.4, 410, 'CCS', 5.5, 48000),
('Rivian', 'R1T', 2024, 'Lithium-Ion', 135.0, 505, 'CCS', 3.0, 85000),
('Tesla', 'Model S', 2023, 'Lithium-Ion', 100.0, 652, 'Supercharger', 1.0, 88000),
('Nissan', 'Leaf', 2020, 'Lithium-Ion', 40.0, 270, 'Type2', 6.0, 32000),
('BMW', 'iX', 2023, 'Lithium-Ion', 105.0, 630, 'CCS', 3.5, 75000),
('Hyundai', 'Ioniq Electric', 2020, 'Lithium-Ion', 38.3, 311, 'Type2', 6.0, 30000),
('Volkswagen', 'e-Golf', 2019, 'Lithium-Ion', 35.8, 230, 'Type2', 7.0, 28000),
('Ford', 'Explorer EV', 2023, 'Lithium-Ion', 77.0, 470, 'Type2', 6.0, 52000),
('Kia', 'Soul EV', 2021, 'Lithium-Ion', 64.0, 385, 'Type2', 7.0, 41000),
('Renault', 'Twingo Electric', 2021, 'Lithium-Ion', 22.0, 190, 'Type2', 8.0, 22000),
('Peugeot', 'e-Rifter', 2022, 'Lithium-Ion', 50.0, 280, 'Type2', 7.5, 35000),
('BYD', 'Han', 2023, 'LFP', 85.4, 610, 'CCS', 3.0, 48000),
('Lucid', 'Air Sapphire', 2024, 'Lithium-Ion', 118.0, 700, 'CCS', 2.0, 95000),
('XPeng', 'G3i', 2022, 'LFP', 66.0, 460, 'Type2', 5.5, 39000),
('Volvo', 'XC40 Recharge', 2022, 'Lithium-Ion', 78.0, 420, 'Type2', 6.0, 47000),
('Toyota', 'C-HR EV', 2021, 'Lithium-Ion', 54.3, 400, 'Type2', 6.5, 43000),
('Rivian', 'Delivery Van', 2023, 'Lithium-Ion', 120.0, 400, 'CCS', 4.0, 75000),
('Tesla', 'Roadster', 2024, 'Lithium-Ion', 200.0, 1000, 'Supercharger', 1.0, 120000),
('Nissan', 'Sakura', 2023, 'Lithium-Ion', 20.0, 180, 'Type2', 8.0, 19000),
('BMW', 'i7', 2023, 'Lithium-Ion', 101.7, 625, 'CCS', 3.0, 95000),
('Hyundai', 'Staria EV', 2024, 'Lithium-Ion', 77.4, 420, 'Type2', 6.5, 55000),
('Volkswagen', 'ID.7', 2024, 'Lithium-Ion', 86.0, 615, 'CCS', 3.5, 64000),
('Toyota', 'Taigan', 2024, 'Solid-State', 85.0, 580, 'CCS', 3.0, 62000),
('Toyota', 'Mirai EV', 2023, 'Lithium-Ion', 75.0, 510, 'Type2', 5.5, 56000),
('Toyota', 'bZ5X', 2024, 'Lithium-Ion', 90.0, 600, 'CCS', 3.2, 64000),
('Toyota', 'Crown EV', 2023, 'Lithium-Ion', 88.0, 570, 'Type2', 4.8, 61000),
('Toyota', 'Highlander EV', 2025, 'Solid-State', 95.0, 620, 'CCS', 2.9, 68000),
('Lexus', 'RZ 450e', 2023, 'Lithium-Ion', 71.4, 440, 'CCS', 5.0, 58000),
('Lexus', 'UX 300e', 2022, 'Lithium-Ion', 54.3, 315, 'Type2', 6.5, 47000),
('Lexus', 'LF-Z', 2024, 'Solid-State', 100.0, 650, 'CCS', 2.5, 72000),
('Lexus', 'NX EV', 2023, 'Lithium-Ion', 75.0, 500, 'Type2', 5.8, 59000),
('Lexus', 'IS EV', 2025, 'Lithium-Ion', 85.0, 560, 'CCS', 3.5, 63000),
('Toyota', 'Yaris EV', 2022, 'Lithium-Ion', 38.0, 280, 'Type2', 7.0, 29000),
('Toyota', 'Corolla EV', 2023, 'Lithium-Ion', 50.0, 350, 'Type2', 6.5, 34000),
('Toyota', 'Camry EV', 2024, 'Lithium-Ion', 65.0, 420, 'CCS', 5.0, 39000),
('Toyota', 'RAV4 Prime', 2023, 'Lithium-Ion', 18.1, 68, 'Type2', 2.5, 42000),
('Toyota', 'Land Cruiser EV', 2025, 'Solid-State', 110.0, 700, 'CCS', 3.0, 85000),
('Lexus', 'GX EV', 2025, 'Solid-State', 105.0, 680, 'CCS', 2.8, 82000),
('Lexus', 'RX EV', 2024, 'Lithium-Ion', 85.0, 560, 'Type2', 4.5, 64000),
('Lexus', 'LS EV', 2025, 'Solid-State', 120.0, 720, 'CCS', 2.5, 95000),
('Toyota', 'Hilux EV', 2024, 'Lithium-Ion', 80.0, 500, 'Type2', 5.5, 58000),
('Toyota', 'Avensis EV', 2023, 'Lithium-Ion', 60.0, 400, 'Type2', 6.0, 42000),
('Toyota', 'Verso EV', 2022, 'Lithium-Ion', 55.0, 370, 'Type2', 6.5, 39000),
('Toyota', 'Aygo EV', 2021, 'Lithium-Ion', 32.0, 250, 'Type2', 7.5, 27000),
('Toyota', 'Sienna EV', 2024, 'Lithium-Ion', 85.0, 540, 'CCS', 4.0, 62000),
('Lexus', 'CT EV', 2023, 'Lithium-Ion', 60.0, 410, 'Type2', 5.5, 47000),
('Lexus', 'ES EV', 2024, 'Lithium-Ion', 75.0, 520, 'CCS', 3.8, 59000),
('Toyota', 'Venza EV', 2023, 'Lithium-Ion', 70.0, 480, 'Type2', 5.0, 53000),
('Toyota', 'Proace EV', 2022, 'Lithium-Ion', 50.0, 330, 'Type2', 6.5, 36000),
('Toyota', 'C-HR EV', 2021, 'Lithium-Ion', 54.3, 400, 'Type2', 6.5, 43000),
('Lexus', 'LX EV', 2025, 'Solid-State', 130.0, 750, 'CCS', 2.5, 98000),
('Lexus', 'RC EV', 2024, 'Lithium-Ion', 78.0, 530, 'Type2', 4.8, 61000),
('Toyota', 'Echo EV', 2022, 'Lithium-Ion', 45.0, 320, 'Type2', 6.5, 31000),
('Toyota', 'Matrix EV', 2023, 'Lithium-Ion', 55.0, 370, 'Type2', 6.0, 35000),
('Toyota', 'Celica EV', 2024, 'Lithium-Ion', 70.0, 500, 'CCS', 4.5, 58000),
('Lexus', 'GS EV', 2024, 'Lithium-Ion', 90.0, 600, 'CCS', 3.0, 67000),
('Lexus', 'IS 500e', 2025, 'Solid-State', 110.0, 700, 'CCS', 2.5, 88000),
('Toyota', 'Prius EV', 2023, 'Lithium-Ion', 60.0, 430, 'Type2', 5.5, 39000),
('Toyota', 'Supra EV', 2024, 'Solid-State', 95.0, 620, 'CCS', 3.0, 72000),
('Lexus', 'LC EV', 2025, 'Solid-State', 125.0, 740, 'CCS', 2.2, 99000),
('Toyota', 'Echo Compact EV', 2022, 'Lithium-Ion', 35.0, 260, 'Type2', 7.0, 28000),
('Toyota', 'Urban Cruiser EV', 2023, 'Lithium-Ion', 50.0, 350, 'Type2', 6.0, 34000),
('Lexus', 'NX 300e', 2023, 'Lithium-Ion', 75.0, 500, 'CCS', 4.0, 58000),
('Toyota', 'Tundra EV', 2025, 'Solid-State', 140.0, 720, 'CCS', 2.8, 88000),
('Toyota', 'Echo Sport EV', 2022, 'Lithium-Ion', 42.0, 300, 'Type2', 6.5, 31000),
('Lexus', 'RX 500e', 2024, 'Lithium-Ion', 85.0, 560, 'CCS', 3.5, 64000),
('Toyota', 'Corolla Cross EV', 2023, 'Lithium-Ion', 65.0, 420, 'Type2', 5.0, 41000),
('Toyota', 'Vitz EV', 2022, 'Lithium-Ion', 40.0, 280, 'Type2', 6.5, 29000),
('Lexus', 'IS 300e', 2023, 'Lithium-Ion', 78.0, 530, 'Type2', 4.8, 61000),
('Toyota', 'Echo X EV', 2023, 'Lithium-Ion', 45.0, 320, 'Type2', 6.5, 31000),
('Lexus', 'LS 600e', 2025, 'Solid-State', 130.0, 750, 'CCS', 2.5, 98000);

SELECT battery_type from electric_vehicles
SELECT manufacturer, model, avg(price_usd) from electric_vehicles
Group By  manufacturer, model

WITH top_models AS (
  SELECT 
    manufacturer, model, MAX(price_usd) AS max_price
  FROM electric_vehicles
  GROUP BY manufacturer, model
)
SELECT 
  e.manufacturer,
  e.model,
  e.year,
  e.battery_type,
  e.range_km,
  e.price_usd
FROM electric_vehicles e
JOIN top_models t ON e.manufacturer = t.manufacturer AND e.model = t.model AND e.price_usd = t.max_price
ORDER BY e.price_usd DESC;

SELECT 
  battery_type,
  COUNT(*) AS vehicle_count,
  ROUND(AVG(range_km), 1) AS avg_range,
  ROUND(AVG(price_usd), 2) AS avg_price
FROM electric_vehicles
GROUP BY battery_type
ORDER BY avg_price DESC;


SELECT 
  manufacturer,
  model,
  ROUND(AVG(price_usd), 2) AS avg_price,
  ROUND(AVG(battery_capacity_kwh)::numeric, 1) AS avg_capacity,
  CASE 
    WHEN AVG(price_usd) < 40000 THEN 'Ekonomik'
    WHEN AVG(price_usd) BETWEEN 40000 AND 70000 THEN 'Orta Segment'
    ELSE 'Premium'
  END AS price_segment
FROM electric_vehicles
GROUP BY manufacturer, model
ORDER BY avg_price DESC;


SELECT 
  manufacturer,
  ROUND(CAST(AVG(battery_capacity_kwh) AS numeric), 1) AS avg_capacity_kwh,
  ROUND(CAST(AVG(price_usd) AS numeric), 0) AS avg_price_usd,
  ROUND(CAST(AVG(price_usd) / NULLIF(AVG(battery_capacity_kwh), 0) AS numeric), 2) AS usd_per_kwh,
  CASE 
    WHEN AVG(price_usd) / NULLIF(AVG(battery_capacity_kwh), 0) < 500 THEN 'YÃ¼ksek fiyat Performans'
    WHEN AVG(price_usd) / NULLIF(AVG(battery_capacity_kwh), 0) BETWEEN 500 AND 800 THEN 'Orta performans'
    ELSE 'Vasat'
  END AS performance_segment
FROM electric_vehicles
GROUP BY manufacturer
ORDER BY usd_per_kwh ASC;





